import mysql.connector

db = mysql.connector.connect(
    host ="localhost",
    user = "root",
    password = "1111"
    )

cursor = db.cursor()

cursor.execute("use student_society")

def execute_query(query):
     cursor.execute(query)
     rows = cursor.fetchall()

     print("Answer of Executed Query : ")
     print("="*130)
     for row in rows:
         print(row)
     print("="*130)

mycursor.execute("""
    CREATE TABLE STUDENT (
        RollNo CHAR(6),
        StudentName VARCHAR(20),
        Course VARCHAR(10),
        DOB Date ,
        PRIMARY KEY (RollNo)
    )
""")

student_sql = "INSERT INTO STUDENT (RollNo, StudentName, Course, DOB) VALUES (%s, %s, %s, %s)"
student_values = [
        ('N00013', 'Srijani', 'ECE', '2003-06-18'),
]
mycursor.executemany(student_sql, student_values)
mydb.commit()
print(f"{mycursor.rowcount} records inserted into STUDENT table.")

 #running all queries
 print("Running first Query :  ")
 execute_query("create view IF NOT EXISTS no_of_enrollments_in_society as
                select society.socName,count(enrollment.rollNo) as enrolled_students from society
                Natural join enrollment
                group by socName;")

 print("Running second Query :  ")
 execute_query("Set @currDate = CURRENT_DATE();
                update enrollment
                Set DOE =
                Case socID
                WHEN "S00001" THEN "2018-01-15"
                WHEN "S00002" THEN @currDate
                WHEN "S00003" THEN "2018-01-02"
                END
                WHERE socID IN ("S00001","S00002","S00003");")

execute_query("ALTER TABLE student ADD COLUMN mobileNumber INT DEFAULT '9999999999';")          
       


1.create user
<>select user , host from mysql.user 
> create user 'abhi'@'localhost' identified by '1234';

2.create role
<>CREATE ROLE role_name1 , [rolename2] [AUTHORIZATION owner_name];
>CREATE ROLE 'Jarvis';
 
3.grant privileges to a role, 
>GRANT ALL ON sakila.* TO 'Jarvis';

4.revoke privileges from a role,
>REVOKE INSERT, UPDATE ON sakila.* FROM 'myrole';

5.create index
<>CREATE INDEX LIndex On users(location);
>CREATE INDEX idx_category ON products (category);
>EXPLAIN SELECT * FROM products WHERE category = 'Electronics';
>DROP INDEX idx_category ON products;